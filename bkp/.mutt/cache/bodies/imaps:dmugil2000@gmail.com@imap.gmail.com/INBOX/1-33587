Delivered-To: dmugil2000@gmail.com
Received: by 2002:a17:906:18e9:0:0:0:0 with SMTP id e9csp1866356ejf;
        Wed, 11 Aug 2021 09:07:24 -0700 (PDT)
X-Received: by 2002:a62:7dcb:0:b029:3af:8a46:a7e4 with SMTP id y194-20020a627dcb0000b02903af8a46a7e4mr29763823pfc.20.1628698044064;
        Wed, 11 Aug 2021 09:07:24 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; t=1628698044; cv=none;
        d=google.com; s=arc-20160816;
        b=xaWofdGjL87RjC+vCyguET6yC1z13KnflSJSb3J+2zxRNi4UKoUVHZKXunkLFdhory
         I3e6dL2gNWNx/HgPjd9c/FYHSfMr4oIteiRtVvjlad8i121jPSCoDNp3Tkvdmayqp63i
         hnQTHcYjaFNiIVcB68qWyFLwqA3TFUi8qgS48+smixywN8JXBASHTwuz6GR9+B0IDIOS
         URt36SivL5bpz5TFakcl097t7O7qxJ/f8RrbNontFza6DdyNlu71aQwCpEzmkMty1zYP
         JTdJu6YfVZvSPiVLNFqNOpiySW854ihH7pRw+7JckU11oGbl+cm1xpl/h5wpDGU4YgN6
         2+4Q==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=google.com; s=arc-20160816;
        h=cc:to:subject:message-id:date:from:in-reply-to:references
         :mime-version:dkim-signature;
        bh=KffArpOyUib3xLvmma0gw4eoYf5u08GOHiGqQNefyKY=;
        b=e5GGaRNVjzwOUTtLe2ddF+h01t1DxxlwsCGo1UD8C1Pyaj08vGhy1CcXghr4Bi2ygo
         xx4ho0GPoGbiNyqWRCzkZloheQ0O2E9qtYkey8o8qD5oYUp/TvI30XsLtohxPtdsZdUu
         RUS98i082zrT2rs5K0R7WV23hVKpAnOsruiP3ZgE9JvRzKtc4wJLTQFni7hPXbPOOy8M
         WlgboEgN5+Eab2Xy52bfwUDVnVKXGM++um80fgzcn+lr8m4eVVD1Q34KTi3oNmqa9KC1
         pHd54Tz9crOJR/81m+djtr7kZhZw4Nmoim0uLmu4OaG/rsfNeZ6SZCTGX01HIL3wUIZB
         pe2g==
ARC-Authentication-Results: i=1; mx.google.com;
       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HPsATQBC;
       spf=pass (google.com: domain of andy.shevchenko@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=andy.shevchenko@gmail.com;
       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com
Return-Path: <andy.shevchenko@gmail.com>
Received: from mail-sor-f41.google.com (mail-sor-f41.google.com. [209.85.220.41])
        by mx.google.com with SMTPS id e6sor1663186pls.9.2021.08.11.09.07.23
        for <dmugil2000@gmail.com>
        (Google Transport Security);
        Wed, 11 Aug 2021 09:07:24 -0700 (PDT)
Received-SPF: pass (google.com: domain of andy.shevchenko@gmail.com designates 209.85.220.41 as permitted sender) client-ip=209.85.220.41;
Authentication-Results: mx.google.com;
       dkim=pass header.i=@gmail.com header.s=20161025 header.b=HPsATQBC;
       spf=pass (google.com: domain of andy.shevchenko@gmail.com designates 209.85.220.41 as permitted sender) smtp.mailfrom=andy.shevchenko@gmail.com;
       dmarc=pass (p=NONE sp=QUARANTINE dis=NONE) header.from=gmail.com
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20161025;
        h=mime-version:references:in-reply-to:from:date:message-id:subject:to
         :cc;
        bh=KffArpOyUib3xLvmma0gw4eoYf5u08GOHiGqQNefyKY=;
        b=HPsATQBC1TxP9YXDvO6/HpnceepixH7+UmUBemM9O8th0lKUu49VkCwyUE7hgiKJu+
         E1iB419oPuAm3guuO9cghFv2L5raN/td2TeRpx8iWqYlB8ywGC7lulfVrCfIzTtYgb9+
         MuIW3p2ylatMLkI/DzZAxcCcacf6cU7voMhmWY+fGW/Jz+DlqTUZ9Ol7crc//34rGb3z
         nGCYRTyyJt4n2ndvZkeSY32nfSc8EjljyrDblJ9asrt2s17SgPkWVeXs9U9XsYHhLpX9
         It0+K+mdbanfy+JZ79Rgb7JcHhAiMr4T4hk9bED+aVJ15CHQ6vK5lEMicRCC5Sr04DiG
         2ZlA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20161025;
        h=x-gm-message-state:mime-version:references:in-reply-to:from:date
         :message-id:subject:to:cc;
        bh=KffArpOyUib3xLvmma0gw4eoYf5u08GOHiGqQNefyKY=;
        b=PrcJB9vAbeomt/e1JoILnfnR8FL+lBY1gWDG6pcndnl9w9mxiqoWIQUd6ApP42MBjm
         /8vAUKrmQMJE7h184DA7JU6e2wUE0d/dGu+X9D67PdN0kbnMtR+r2hyyzblVXMzHSDD/
         Fw8lH9IybNbgT8LE+8J4FWU8IbrQvifB4ouBpN56fJ0r0bDHCXr0TPALQASgo431nqJl
         kLlB8MtSJQKO16mQOONT9nBf5H8zg1f6a1SVLtdtaqBXPEPGlKierN/OKtkHVI2UUqud
         X+907O4XvpjVLJ++mllvfYGJduPnsr0QcuS1jfjoQZgCyILm60F40CTP1/B7qwsW831r
         IkuA==
X-Gm-Message-State: AOAM530rq/0zGFMkRRgRF/oVmcJb85c/f4dJs45rrQcGcKWczY0f7tTe
	YAFOPkagxIPYH0QLYPqlGlFWov1DRyVC8Y0gSg0=
X-Google-Smtp-Source: ABdhPJxT/bamFNOzxnUwiKPLoYVj6shFGLY6RHKownLvpNsQtzfsSR4MoEDaHdyJpn6tl9YNSsIMvQ8w5e31/7xAJIE=
X-Received: by 2002:a17:902:e786:b029:12d:2a7:365f with SMTP id
 cp6-20020a170902e786b029012d02a7365fmr4813354plb.21.1628698043540; Wed, 11
 Aug 2021 09:07:23 -0700 (PDT)
MIME-Version: 1.0
References: <20210809075745.160042-1-dmugil2000@gmail.com> <20210809075745.160042-3-dmugil2000@gmail.com>
 <CAHp75Ve=D1d5wFZgNseP=wGpteEkZHnmAi7j9ykKC+u_NrR5xw@mail.gmail.com> <013bcb79-c496-44d8-2e93-57eb57834ee0@metafoo.de>
In-Reply-To: <013bcb79-c496-44d8-2e93-57eb57834ee0@metafoo.de>
From: Andy Shevchenko <andy.shevchenko@gmail.com>
Date: Wed, 11 Aug 2021 19:06:43 +0300
Message-ID: <CAHp75VcvA=dDOJXSFzgz69JVgbez4Lz27EGOEF7JWUehyrwQrA@mail.gmail.com>
Subject: Re: [PATCH v2 2/2] iio: potentiometer: Add driver support for AD5110
To: Lars-Peter Clausen <lars@metafoo.de>
Cc: Mugilraj Dhavachelvan <dmugil2000@gmail.com>, "Bogdan, Dragos" <Dragos.Bogdan@analog.com>, 
	Darius <Darius.Berghe@analog.com>, Rob Herring <robh+dt@kernel.org>, 
	Jonathan Cameron <jic23@kernel.org>, Michael Hennerich <Michael.Hennerich@analog.com>, 
	Guenter Roeck <linux@roeck-us.net>, Chris Packham <chris.packham@alliedtelesis.co.nz>, 
	Slawomir Stepien <sst@poczta.fm>, Krzysztof Kozlowski <krzk@kernel.org>, 
	Alexandre Belloni <alexandre.belloni@bootlin.com>, 
	Alexandru Ardelean <alexandru.ardelean@analog.com>, devicetree <devicetree@vger.kernel.org>, 
	Linux Kernel Mailing List <linux-kernel@vger.kernel.org>, linux-iio <linux-iio@vger.kernel.org>
Content-Type: text/plain; charset="UTF-8"

On Wed, Aug 11, 2021 at 11:15 AM Lars-Peter Clausen <lars@metafoo.de> wrote:
> On 8/10/21 2:49 PM, Andy Shevchenko wrote:
> >
> >> +       data->tol = data->cfg->kohms * (val & GENMASK(6, 0)) * 10 / 8;
> >> +       if (!(val & BIT(7)))
> >> +               data->tol *= -1;
> > Shouldn't you simple use corresponding sign_extend*()?
> The data is encoded a sign-magnitude. sign_extend() works for two's
> complement numbers.

Good catch!
I'm wondering if it's a good idea to have a sign_magnitude_to_int()
helper or so?

-- 
With Best Regards,
Andy Shevchenko
